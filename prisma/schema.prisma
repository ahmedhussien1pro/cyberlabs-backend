// This is your Prisma schema file,\n// learn more about it in the docs: https://pris.ly/d/prisma-schema\n\n// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?\n// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init\n\ngenerator client {\n  provider      = \"prisma-client-js\"\n  binaryTargets = [\"native\", \"rhel-openssl-3.0.x\"]\n}\n\ndatasource db {\n  provider = \"postgresql\"\n  url      = env(\"DATABASE_URL\")\n}\n\n// ============================================================================\n// ENUMS\n// ============================================================================\n\nenum PathModuleType {\n  COURSE\n  LAB\n  QUIZ\n  PROJECT\n}\n\nenum PathModuleStatus {\n  PUBLISHED\n  COMING_SOON\n  DRAFT\n}\n\n\nenum Role {\n  ADMIN\n  USER\n  CONTENT_CREATOR\n  STUDENT // إضافة STUDENT للـ Auth Module\n  INSTRUCTOR // إضافة INSTRUCTOR للـ Courses\n}\n\nenum InternalRole {\n  SOC\n  PENTEST\n  GRC\n  BLUE_TEAM\n  RED_TEAM\n  SECURITY_ANALYST\n  STUDENT\n}\n\nenum BadgeType {\n  COURSE_COMPLETION\n  LAB_SOLVED\n  STREAK\n  COMMUNITY\n  CONTRIBUTION\n  CUSTOM\n}\n\nenum AchievementCategory {\n  LEARNING\n  COMMUNITY\n  COMPETITION\n  MILESTONE\n  CUSTOM\n}\n\nenum XPSource {\n  COURSE\n  LAB\n  QUIZ\n  MANUAL\n  LOGIN_BONUS\n  SUBSCRIPTION_BONUS\n  CUSTOM\n}\n\nenum STATE {\n  PUBLISHED\n  COMING_SOON\n  DRAFT // إضافة DRAFT للكورسات غير المنشورة\n}\n\nenum LeaderboardPeriod {\n  DAILY\n  WEEKLY\n  MONTHLY\n  ALL_TIME\n}\n\nenum Difficulty {\n  BEGINNER\n  INTERMEDIATE\n  ADVANCED\n}\n\nenum AssessmentType {\n  QUIZ\n  EXAM\n  PRACTICAL\n}\n\nenum SkillLevel {\n  BEGINNER\n  INTERMEDIATE\n  ADVANCED\n  EXPERT\n}\n\nenum SocialPlatform {\n  GITHUB\n  LINKEDIN\n  TWITTER\n  YOUTUBE\n  FACEBOOK\n  PORTFOLIO\n  EMAIL\n  OTHER\n}\n\nenum SubscriptionDuration {\n  MONTHLY\n  YEARLY\n}\n\nenum NotificationPriority {\n  LOW\n  MEDIUM\n  HIGH\n  URGENT\n}\n\nenum CATEGORY {\n  WEB_SECURITY\n  PENETRATION_TESTING\n  MALWARE_ANALYSIS\n  CLOUD_SECURITY\n  FUNDAMENTALS\n  CRYPTOGRAPHY\n  NETWORK_SECURITY\n  TOOLS_AND_TECHNIQUES\n  CAREER_AND_INDUSTRY\n}\n\nenum CourseAccess {\n  FREE\n  PRO\n  PREMIUM\n}\n\nenum CourseColor {\n  EMERALD\n  BLUE\n  VIOLET\n  ORANGE\n  ROSE\n  CYAN\n}\n\nenum CourseContentType {\n  PRACTICAL\n  THEORETICAL\n  MIXED\n}\n\nenum SubscriptionStatus {\n  ACTIVE\n  TRIALING\n  PAST_DUE\n  CANCELED\n  INCOMPLETE\n  INCOMPLETE_EXPIRED\n  UNPAID\n}\n\nenum BillingCycle {\n  MONTHLY\n  ANNUAL\n}\n\nenum CertificateStatus {\n  ACTIVE\n  REVOKED\n  EXPIRED\n}\n\nenum LessonType {\n  VIDEO\n  ARTICLE\n  QUIZ\n}\n\nenum CourseLevel {\n  BEGINNER\n  INTERMEDIATE\n  ADVANCED\n  EXPERT\n}\n\nenum LabExecutionMode {\n  FRONTEND\n  SHARED_BACKEND\n  DOCKER\n}\n\n// ============================================================================\n// CORE USER MODEL\n// ============================================================================\n\nmodel User {\n  id          String    @id @default(uuid())\n  createdAt   DateTime  @default(now())\n  updatedAt   DateTime  @updatedAt\n  name        String    @unique\n  email       String    @unique\n  password    String\n  bio         String?\n  ar_bio      String?\n  address     String?\n  birthday    DateTime?\n  phoneNumber String?\n  isVerified  Boolean   @default(false) @map(\"is_verified\")\n\n  // Security fields\n  lastPasswordChange DateTime?\n  deletedAt          DateTime?\n  deletionReason     String?\n\n  // Auth fields (من الـ Auth Module)\n  refreshToken        String?\n  isEmailVerified     Boolean   @default(false)\n  failedLoginAttempts Int       @default(0)\n  lockedUntil         DateTime?\n  twoFactorSecret     String?\n  twoFactorEnabled    Boolean   @default(false)\n  avatarUrl           String?\n  preferences         Json?\n  isActive            Boolean   @default(true)\n  lastLoginAt         DateTime?\n  stripeCustomerId String?\n\n  // LMS Relations\n  enrollments         Enrollment[]\n  reviews             Review[]\n  lessonCompletions   LessonCompletion[]\n  labSubmissions      LabSubmission[]\n  labInstances        LabInstance[]\n  courseFavorites     CourseFavorite[]\n  pathEnrollments     PathEnrollment[]\n  // Course instructor relation\n  coursesAsInstructor Course[]           @relation(\"CourseInstructor\")\n\n  // File management\n  files File[]\n  image Image?\n\n  // Roles\n  role         Role          @default(USER)\n  internalRole InternalRole? @default(STUDENT)\n\n  // Profile details\n  socialLinks    SocialLink[]\n  education      Education[]\n  skills         UserSkill[]\n  certifications Certification[]\n\n  // Gamification\n  achievements          UserAchievement[]\n  badges                UserBadge[]\n  careerPaths           UserCareerPath[]\n  points                UserPoints?\n  pointsHistory         PointsHistory[]\n  xplogs                XPLog[]\n  pointsLogs            PointsLog[]\n  leaderboardEntries    LeaderboardEntry[]\n  userRewards           UserReward[]\n  goals                 Goal[]\n  // Learning progress\n  labProgress           UserLabProgress[]\n  courseRegistrations   CourseRegistration[]\n  assessmentSubmissions AssessmentSubmission[]\n  lessonProgress        LessonProgress[]\n  issuedCertificates    IssuedCertificate[]\n  labGenericUsers       LabGenericUser[]\n  labGenericBanks       LabGenericBank[]\n  labGenericContents    LabGenericContent[]\n  labGenericLogs        LabGenericLog[]\n  labLaunchTokens       LabLaunchToken[]\n  // Activity & stats\n  dayActivity           UserActivity[]\n\n  stats UserStats?\n\n  // Security & logs\n  security             UserSecurity?\n  securityLogs         SecurityLog[]\n  ValidationNumber     ValidationNumber[]\n  refreshTokens        RefreshToken[]\n  passwordResetTokens  PasswordResetToken[]\n  emailChangeRequests  EmailChangeRequest[]\n  twoFactorBackupCodes TwoFactorBackupCode[]\n  oauthAccounts        OAuthAccount[]\n\n  // Subscriptions\n  subscriptions Subscription[]\n\n  // Notifications\n  notifications        Notification[]\n  notificationSettings NotificationSettings?\n\n  // Community\n  discussions   Discussion[]\n  comments      Comment[]\n  labReviews    LabReview[]\n  courseReviews CourseReview[]\n\n  @@index([email])\n  @@index([createdAt])\n  @@index([role])\n  @@index([isVerified])\n  @@map(\"users\")\n}\n\n// ============================================================================\n// AUTHENTICATION & SECURITY\n// ============================================================================\n\nmodel RefreshToken {\n  id        String    @id @default(uuid())\n  userId    String\n  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)\n  tokenHash String\n  expiresAt DateTime\n  createdAt DateTime  @default(now())\n  revokedAt DateTime?\n  userAgent String?\n  ip        String?\n\n  @@index([userId])\n  @@index([expiresAt])\n  @@map(\"refresh_tokens\")\n}\n\nmodel ValidationNumber {\n  id         String   @id @default(uuid())\n  number     String\n  isVerified Boolean  @default(false) @map(\"is_verified\")\n  createdAt  DateTime @default(now())\n  expiration BigInt\n  used       Boolean  @default(false)\n  userId     String   @unique\n  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@index([expiration])\n}\n\nmodel PasswordResetToken {\n  id        String    @id @default(uuid())\n  userId    String\n  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)\n  token     String    @unique\n  expiresAt DateTime\n  usedAt    DateTime?\n  createdAt DateTime  @default(now())\n  ip        String?\n  userAgent String?\n\n  @@index([userId])\n  @@index([token])\n  @@index([expiresAt])\n  @@map(\"password_reset_tokens\")\n}\n\nmodel EmailChangeRequest {\n  id         String    @id @default(uuid())\n  userId     String\n  user       User      @relation(fields: [userId], references: [id], onDelete: Cascade)\n  newEmail   String\n  token      String    @unique\n  expiresAt  DateTime\n  verifiedAt DateTime?\n  createdAt  DateTime  @default(now())\n\n  @@index([userId])\n  @@index([token])\n  @@index([expiresAt])\n  @@map(\"email_change_requests\")\n}\n\nmodel TwoFactorBackupCode {\n  id        String    @id @default(uuid())\n  userId    String\n  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)\n  code      String    @unique\n  usedAt    DateTime?\n  createdAt DateTime  @default(now())\n\n  @@index([userId])\n  @@index([code])\n  @@map(\"two_factor_backup_codes\")\n}\n\nmodel OAuthAccount {\n  id           String   @id @default(uuid())\n  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId       String\n  provider     String\n  providerId   String\n  accessToken  String?\n  refreshToken String?\n  createdAt    DateTime @default(now())\n\n  @@unique([provider, providerId])\n  @@index([userId])\n  @@map(\"oauth_accounts\")\n}\n\nmodel SecurityLog {\n  id        String   @id @default(uuid())\n  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId    String\n  action    String\n  ip        String?\n  userAgent String?\n  success   Boolean\n  details   String?\n  createdAt DateTime @default(now())\n\n  @@index([userId, createdAt])\n  @@index([createdAt])\n  @@map(\"security_logs\")\n}\n\nmodel UserSecurity {\n  id                  String    @id @default(uuid())\n  user                User      @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId              String    @unique\n  lastLogin           DateTime?\n  loginAttempts       Int       @default(0)\n  lockedUntil         DateTime?\n  isSuspended         Boolean   @default(false)\n  suspensionReason    String?\n  suspendedAt         DateTime?\n  twoFactorEnabled    Boolean   @default(false)\n  twoFactorSecret     String?\n  twoFactorVerifiedAt DateTime?\n\n  @@map(\"user_security\")\n}\n\n// ============================================================================\n// FILE MANAGEMENT\n// ============================================================================\n\nmodel File {\n  id        String   @id @default(uuid())\n  createdAt DateTime @default(now())\n  name      String\n  path      String\n  url       String\n  filename  String?\n  mimeType  String\n  size      Int?\n  user      User?    @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId    String?\n\n  @@index([userId])\n  @@map(\"files\")\n}\n\nmodel Image {\n  id        String   @id @default(uuid())\n  createdAt DateTime @default(now())\n  name      String\n  mimeType  String\n  alt       String?\n  url       String   @default(\"placeholder.png\")\n  userId    String   @unique\n  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@map(\"images\")\n}\n\n// ============================================================================\n// NOTIFICATIONS\n// ============================================================================\n\nmodel Notification {\n  id         String               @id @default(uuid())\n  user       User                 @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId     String\n  type       String\n  title      String\n  ar_title   String?\n  body       String?\n  ar_body    String?\n  isRead     Boolean              @default(false)\n  isArchived Boolean              @default(false)\n  actionUrl  String?\n  priority   NotificationPriority @default(MEDIUM)\n  expiresAt  DateTime?\n  createdAt  DateTime             @default(now())\n\n  @@index([userId, isArchived])\n  @@index([userId, isRead])\n  @@index([createdAt])\n  @@map(\"notifications\")\n}\n\nmodel NotificationSettings {\n  id                 String  @id @default(uuid())\n  user               User    @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId             String  @unique\n  emailNotifications Boolean @default(true)\n  pushNotifications  Boolean @default(true)\n  courseUpdates      Boolean @default(true)\n  labUpdates         Boolean @default(true)\n  achievementAlerts  Boolean @default(true)\n  weeklyDigest       Boolean @default(true)\n  marketingEmails    Boolean @default(false)\n\n  @@map(\"notification_settings\")\n}\n\n// ============================================================================\n// GAMIFICATION SYSTEM\n// ============================================================================\n\nmodel Badge {\n  id             String    @id @default(uuid())\n  code           String    @unique\n  title          String\n  ar_title       String?\n  description    String?\n  ar_description String?\n  iconUrl        String?\n  type           BadgeType @default(COURSE_COMPLETION)\n  xpReward       Int       @default(0)\n  pointsReward   Int       @default(0)\n  createdAt      DateTime  @default(now())\n  updatedAt      DateTime  @updatedAt\n\n  userBadges UserBadge[]\n\n  @@map(\"badges\")\n}\n\nmodel UserBadge {\n  id      String @id @default(uuid())\n  user    User   @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId  String\n  badge   Badge  @relation(fields: [badgeId], references: [id], onDelete: Cascade)\n  badgeId String\n\n  awardedAt DateTime @default(now())\n  awardedBy String?\n  context   String?\n  meta      Json?\n\n  @@unique([userId, badgeId, context])\n  @@index([userId])\n  @@index([badgeId])\n  @@map(\"user_badges\")\n}\n\nmodel Achievement {\n  id             String              @id @default(uuid())\n  code           String              @unique\n  title          String\n  ar_title       String?\n  description    String?\n  ar_description String?\n  category       AchievementCategory @default(LEARNING)\n  xpReward       Int                 @default(0)\n  pointsReward   Int                 @default(0)\n  iconUrl        String?\n  createdAt      DateTime            @default(now())\n  updatedAt      DateTime            @updatedAt\n\n  userAchievements UserAchievement[]\n\n  @@map(\"achievements\")\n}\n\nmodel UserAchievement {\n  id            String      @id @default(uuid())\n  user          User        @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId        String\n  achievement   Achievement @relation(fields: [achievementId], references: [id], onDelete: Cascade)\n  achievementId String\n\n  progress   Float?    @default(0)\n  achievedAt DateTime?\n  awardedBy  String?\n  context    String?\n  meta       Json?\n\n  @@unique([userId, achievementId])\n  @@index([userId])\n  @@index([achievementId])\n  @@map(\"user_achievements\")\n}\n\nmodel XPLog {\n  id        String   @id @default(uuid())\n  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId    String\n  source    XPSource\n  amount    Int\n  reason    String?\n  ar_reason String?\n  context   String?\n  createdAt DateTime @default(now())\n\n  @@index([userId])\n  @@index([createdAt])\n  @@map(\"xp_logs\")\n}\n\nmodel PointsLog {\n  id        String   @id @default(uuid())\n  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId    String\n  amount    Int\n  reason    String?\n  ar_reason String?\n  context   String?\n  createdAt DateTime @default(now())\n\n  @@index([userId])\n  @@index([createdAt])\n  @@map(\"points_logs\")\n}\n\nmodel Level {\n  id        Int      @id @default(autoincrement())\n  level     Int      @unique\n  xpNeeded  Int\n  title     String?\n  ar_title  String?\n  createdAt DateTime @default(now())\n\n  @@map(\"levels\")\n}\n\nmodel Leaderboard {\n  id          String            @id @default(uuid())\n  period      LeaderboardPeriod\n  periodStart DateTime\n  periodEnd   DateTime\n  createdAt   DateTime          @default(now())\n\n  entries LeaderboardEntry[]\n\n  @@index([period, periodStart, periodEnd])\n  @@map(\"leaderboards\")\n}\n\nmodel LeaderboardEntry {\n  id            String      @id @default(uuid())\n  leaderboard   Leaderboard @relation(fields: [leaderboardId], references: [id], onDelete: Cascade)\n  leaderboardId String\n  user          User        @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId        String\n  rank          Int\n  score         Int\n  extra         Json?\n  createdAt     DateTime    @default(now())\n\n  @@unique([leaderboardId, userId])\n  @@index([leaderboardId, rank])\n  @@index([userId])\n  @@map(\"leaderboard_entries\")\n}\n\nmodel UserActivity {\n  id             String   @id @default(cuid())\n  userId         String\n  date           DateTime @db.Date\n  activeMinutes  Int      @default(0)\n  completedTasks Int      @default(0)\n  labsSolved     Int      @default(0)\n  createdAt      DateTime @default(now())\n  updatedAt      DateTime @updatedAt\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@unique([userId, date])\n  @@index([userId, date])\n  @@map(\"user_activities\")\n}\n\nmodel Reward {\n  id             String   @id @default(uuid())\n  code           String   @unique\n  title          String\n  ar_title       String?\n  description    String?\n  ar_description String?\n  costPoints     Int      @default(0)\n  stock          Int?\n  isActive       Boolean  @default(true)\n  createdAt      DateTime @default(now())\n  updatedAt      DateTime @updatedAt\n\n  redemptions UserReward[]\n\n  @@map(\"rewards\")\n}\n\nmodel UserReward {\n  id         String   @id @default(uuid())\n  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId     String\n  reward     Reward   @relation(fields: [rewardId], references: [id], onDelete: Cascade)\n  rewardId   String\n  redeemedAt DateTime @default(now())\n  meta       Json?\n\n  @@index([userId])\n  @@index([rewardId])\n  @@map(\"user_rewards\")\n}\n\nmodel UserPoints {\n  id          String   @id @default(uuid())\n  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId      String   @unique\n  totalPoints Int      @default(0)\n  totalXP     Int      @default(0)\n  level       Int      @default(1)\n  updatedAt   DateTime @updatedAt\n\n  @@map(\"user_points\")\n}\n\nmodel PointsHistory {\n  id        String   @id @default(uuid())\n  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId    String\n  points    Int\n  reason    String?\n  ar_reason String?\n  createdAt DateTime @default(now())\n\n  @@index([userId])\n  @@index([createdAt])\n  @@map(\"points_history\")\n}\n\n// ============================================================================\n// COURSES & LEARNING CONTENT (LMS System)\n// ============================================================================\n\nmodel Course {\n  id                 String            @id @default(uuid())\n  slug               String            @unique\n  title              String\n  ar_title           String?\n  description        String?\n  ar_description     String?\n  longDescription    String?           @db.Text\n  ar_longDescription String?           @db.Text\n  thumbnail          String?\n  backgroundImage    String?\n  difficulty         Difficulty        @default(BEGINNER)\n  ar_difficulty      String?\n  duration           Int               @default(120)\n  estimatedHours     Int?\n  image              String?\n  link               String?\n  topics             String[]\n  ar_topics          String[]\n  skills             String[]\n  ar_skills          String[]\n  prerequisites      String[]\n  ar_prerequisites   String[]\n  tags               String[]\n  labsLink           String?\n  isNew              Boolean           @default(false)\n  category           CATEGORY          @default(FUNDAMENTALS)\n  ar_category        String?\n  contentType        CourseContentType @default(MIXED)\n  access             CourseAccess      @default(FREE)\n  color              CourseColor       @default(BLUE)\n  state              STATE             @default(PUBLISHED)\n\n  // LMS specific fields\n  instructorId    String\n  price           Float     @default(0)\n  enrollmentCount Int       @default(0)\n  averageRating   Float     @default(0)\n  reviewCount     Int       @default(0)\n  totalTopics     Int       @default(0)\n  isPublished     Boolean   @default(false)\n  publishedAt     DateTime?\n  isFeatured      Boolean   @default(false)\n\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n\n  // Relations\n  instructor  User             @relation(\"CourseInstructor\", fields: [instructorId], references: [id])\n  enrollments Enrollment[]\n  sections    Section[]\n  lessons     Lesson[]\n  reviews     Review[]\n  favorites   CourseFavorite[]\n  pathModules  PathModule[]\n\n  // Original relations (keep intact)\n  modules             Module[]\n  labs                Lab[]\n  registrations       CourseRegistration[]\n  assessments         Assessment[]\n  discussions         Discussion[]\n  certificateTemplate CertificateTemplate?\n  issuedCertificates  IssuedCertificate[]\n  courseReviews       CourseReview[]\n\n  @@index([instructorId])\n  @@index([difficulty])\n  @@index([isPublished])\n  @@index([createdAt])\n  @@map(\"courses\")\n}\n\n// ============================================================================\n// LMS Models (للـ Learning Platform)\n// ============================================================================\n\nmodel Enrollment {\n  id             String    @id @default(cuid())\n  userId         String\n  courseId       String\n  progress       Float     @default(0)\n  isCompleted    Boolean   @default(false)\n  enrolledAt     DateTime  @default(now())\n  completedAt    DateTime?\n  lastAccessedAt DateTime?\n  createdAt      DateTime  @default(now())\n  updatedAt      DateTime  @updatedAt\n\n  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)\n  course Course @relation(fields: [courseId], references: [id], onDelete: Cascade)\n\n  @@unique([userId, courseId])\n  @@index([userId])\n  @@index([courseId])\n  @@index([isCompleted])\n  @@map(\"enrollments\")\n}\n\nmodel Section {\n  id          String   @id @default(cuid())\n  courseId    String\n  title       String\n  ar_title    String?\n  description String?\n  order       Int\n  isPublished Boolean  @default(true)\n  createdAt   DateTime @default(now())\n  updatedAt   DateTime @updatedAt\n\n  course  Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)\n  lessons Lesson[]\n\n  @@unique([courseId, order])\n  @@index([courseId])\n  @@map(\"sections\")\n}\n\nmodel Lesson {\n  id          String     @id @default(uuid())\n  sectionId   String\n  courseId    String\n  title       String\n  ar_title    String?\n  description String?\n  content     String     @db.Text\n  ar_content  String?    @db.Text\n  videoUrl    String?\n  duration    Int?\n  type        LessonType @default(VIDEO)\n  order       Int\n  isPreview   Boolean    @default(false)\n  isPublished Boolean    @default(true)\n  createdAt   DateTime   @default(now())\n  updatedAt   DateTime   @updatedAt\n\n  // Relations for LMS\n  section     Section            @relation(fields: [sectionId], references: [id], onDelete: Cascade)\n  course      Course             @relation(fields: [courseId], references: [id], onDelete: Cascade)\n  completions LessonCompletion[]\n\n  // Original relations (keep intact)\n  moduleId String\n  module   Module           @relation(fields: [moduleId], references: [id], onDelete: Cascade)\n  progress LessonProgress[]\n\n  @@unique([sectionId, order])\n  @@unique([moduleId, order])\n  @@index([sectionId])\n  @@index([courseId])\n  @@index([moduleId])\n  @@map(\"lessons\")\n}\n\nmodel LessonCompletion {\n  id          String   @id @default(cuid())\n  userId      String\n  lessonId    String\n  completedAt DateTime @default(now())\n  createdAt   DateTime @default(now())\n\n  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)\n  lesson Lesson @relation(fields: [lessonId], references: [id], onDelete: Cascade)\n\n  @@unique([userId, lessonId])\n  @@index([userId])\n  @@index([lessonId])\n  @@map(\"lesson_completions\")\n}\n\nmodel Review {\n  id           String   @id @default(cuid())\n  userId       String\n  courseId     String\n  rating       Int\n  comment      String   @db.Text\n  ar_comment   String?  @db.Text\n  helpfulCount Int      @default(0)\n  isPublished  Boolean  @default(true)\n  createdAt    DateTime @default(now())\n  updatedAt    DateTime @updatedAt\n\n  user    User            @relation(fields: [userId], references: [id], onDelete: Cascade)\n  course  Course          @relation(fields: [courseId], references: [id], onDelete: Cascade)\n  helpful ReviewHelpful[]\n\n  @@unique([userId, courseId])\n  @@index([userId])\n  @@index([courseId])\n  @@index([rating])\n  @@map(\"reviews\")\n}\n\nmodel ReviewHelpful {\n  id        String   @id @default(cuid())\n  userId    String\n  reviewId  String\n  isHelpful Boolean\n  createdAt DateTime @default(now())\n\n  review Review @relation(fields: [reviewId], references: [id], onDelete: Cascade)\n\n  @@unique([userId, reviewId])\n  @@index([reviewId])\n  @@map(\"review_helpful\")\n}\n\n// ============================================================================\n// ORIGINAL MODELS (Keep as is)\n// ============================================================================\n\nmodel Module {\n  id             String   @id @default(uuid())\n  courseId       String\n  course         Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)\n  title          String\n  ar_title       String?\n  description    String?\n  ar_description String?\n  order          Int\n  createdAt      DateTime @default(now())\n  updatedAt      DateTime @updatedAt\n\n  lessons Lesson[]\n\n  @@unique([courseId, order])\n  @@index([courseId])\n  @@map(\"modules\")\n}\n\nmodel LessonProgress {\n  id          String    @id @default(uuid())\n  userId      String\n  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)\n  lessonId    String\n  lesson      Lesson    @relation(fields: [lessonId], references: [id], onDelete: Cascade)\n  completed   Boolean   @default(false)\n  completedAt DateTime?\n  createdAt   DateTime  @default(now())\n\n  @@unique([userId, lessonId])\n  @@index([userId])\n  @@map(\"lesson_progress\")\n}\n\nmodel CourseRegistration {\n  id          String    @id @default(uuid())\n  courseId    String\n  course      Course    @relation(fields: [courseId], references: [id], onDelete: Cascade)\n  userId      String\n  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)\n  progress    Int       @default(0)\n  startedAt   DateTime  @default(now())\n  completedAt DateTime?\n\n  @@unique([userId, courseId])\n  @@index([userId])\n  @@index([courseId])\n  @@map(\"course_registrations\")\n}\n\n// ============================================================================\n// LABS\n// ============================================================================\n\nmodel Lab {\n  id       String  @id @default(uuid())\n  course   Course? @relation(fields: [courseId], references: [id], onDelete: SetNull)\n  courseId String?\n\n  title          String\n  ar_title       String?\n  description    String?\n  ar_description String?\n  difficulty     Difficulty @default(BEGINNER)\n  \n  // -- NEW FIELDS FOR LAB ENGINE V2 --\n  category       CATEGORY   @default(WEB_SECURITY)\n  executionMode  LabExecutionMode @default(SHARED_BACKEND)\n  scenario       String?    @db.Text\n  ar_scenario    String?    @db.Text\n  engineConfig   Json?      // Stores targetUrl, specific DB type, Docker compose path, etc.\n  skills         String[]   // e.g., [\"SQLi\", \"Reconnaissance\"]\n  // ----------------------------------\n  \n  duration       Int?\n  labUrl         String? // Keep for legacy, but engineConfig.targetUrl is better for V2\n  flagAnswer     String?\n  maxAttempts    Int?\n  timeLimit      Int?\n  xpReward       Int        @default(0)\n  pointsReward   Int        @default(0)\n  pointsPerHint  Int        @default(10)\n  pointsPerFail  Int        @default(5)\n  initialState   Json       @default(\"{}\")\n  isolationMode  String     @default(\"database\")\n\n  steps Json?\n\n  isPublished Boolean  @default(false)\n  createdAt   DateTime @default(now())\n  updatedAt   DateTime @updatedAt\n\n  pathModules     PathModule[]\n  usersProgress   UserLabProgress[]\n  hints           LabHint[]\n  discussions     Discussion[]\n  reviews         LabReview[]\n  submissions     LabSubmission[]\n  instances       LabInstance[]\n  launchTokens    LabLaunchToken[]\n  genericUsers    LabGenericUser[]\n  genericBanks    LabGenericBank[]\n  genericContents LabGenericContent[]\n  genericLogs     LabGenericLog[]\n\n  @@index([courseId])\n  @@index([difficulty])\n  @@index([isPublished])\n  @@map(\"labs\")\n}\n\nmodel LabInstance {\n  id     String @id @default(cuid())\n  userId String\n  labId  String\n\n  // Lab-specific state (stored as JSON)\n  state Json @default(\"{}\")\n\n  // Example for IDOR lab:\n  balance Int @default(5000)\n\n  // Metadata\n  isActive  Boolean   @default(true)\n  startedAt DateTime  @default(now())\n  expiresAt DateTime? // Optional: auto-cleanup old instances\n  \n  // Launch token reference\n  launchTokens LabLaunchToken[]\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n  lab  Lab  @relation(fields: [labId], references: [id], onDelete: Cascade)\n\n  @@unique([userId, labId])\n  @@index([userId])\n  @@index([labId])\n  @@map(\"LabInstance\")\n}\n\n// Opaque launch code for lab redirects\nmodel LabLaunchToken {\n  id         String   @id @default(uuid())\n  token      String   @unique\n  userId     String\n  labId      String\n  instanceId String\n  expiresAt  DateTime\n  usedAt     DateTime?\n  createdAt  DateTime @default(now())\n\n  user     User        @relation(fields: [userId], references: [id], onDelete: Cascade)\n  lab      Lab         @relation(fields: [labId], references: [id], onDelete: Cascade)\n  instance LabInstance @relation(fields: [instanceId], references: [id], onDelete: Cascade)\n\n  @@index([token])\n  @@index([expiresAt])\n  @@map(\"lab_launch_tokens\")\n}\n\nmodel LabHint {\n  id         String  @id @default(uuid())\n  labId      String\n  lab        Lab     @relation(fields: [labId], references: [id], onDelete: Cascade)\n  content    String  @db.Text\n  ar_content String? @db.Text\n  order      Int\n  xpCost     Int     @default(0)\n\n  @@unique([labId, order])\n  @@index([labId])\n  @@map(\"lab_hints\")\n}\n\nmodel UserLabProgress {\n  id     String @id @default(uuid())\n  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId String\n  lab    Lab    @relation(fields: [labId], references: [id], onDelete: Cascade)\n  labId  String\n\n  progress      Int       @default(0)\n  attempts      Int       @default(0)\n  hintsUsed     Int       @default(0)\n  flagSubmitted Boolean   @default(false)\n  startedAt     DateTime  @default(now())\n  completedAt   DateTime?\n  lastAccess    DateTime?\n\n  @@unique([userId, labId])\n  @@index([userId])\n  @@index([labId])\n  @@index([completedAt])\n  @@map(\"user_lab_progress\")\n}\n\n// ============================================================================\n// ASSESSMENTS & QUIZZES\n// ============================================================================\n\nmodel Assessment {\n  id           String         @id @default(uuid())\n  course       Course?        @relation(fields: [courseId], references: [id], onDelete: SetNull)\n  courseId     String?\n  title        String\n  ar_title     String?\n  type         AssessmentType @default(QUIZ)\n  duration     Int?\n  passingScore Int            @default(70)\n  questions    Json\n\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n\n  submissions AssessmentSubmission[]\n\n  @@index([courseId])\n  @@map(\"assessments\")\n}\n\nmodel AssessmentSubmission {\n  id           String     @id @default(uuid())\n  userId       String\n  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)\n  assessmentId String\n  assessment   Assessment @relation(fields: [assessmentId], references: [id], onDelete: Cascade)\n  answers      Json\n  score        Int?\n  passed       Boolean    @default(false)\n  submittedAt  DateTime   @default(now())\n\n  @@index([userId])\n  @@index([assessmentId])\n  @@index([submittedAt])\n  @@map(\"assessment_submissions\")\n}\n\n// ============================================================================\n// CERTIFICATES\n// ============================================================================\n\nmodel CertificateTemplate {\n  id          String   @id @default(uuid())\n  courseId    String   @unique\n  course      Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)\n  templateUrl String\n  variables   Json?\n  createdAt   DateTime @default(now())\n  updatedAt   DateTime @updatedAt\n\n  @@map(\"certificate_templates\")\n}\n\nmodel IssuedCertificate {\n  id             String            @id @default(uuid())\n  userId         String\n  user           User              @relation(fields: [userId], references: [id], onDelete: Cascade)\n  courseId       String\n  course         Course            @relation(fields: [courseId], references: [id], onDelete: Cascade)\n  certificateUrl String\n  verificationId String            @unique\n  status         CertificateStatus @default(ACTIVE)\n  issuedAt       DateTime          @default(now())\n  expiresAt      DateTime?\n  revokedAt      DateTime?\n  revokeReason   String?\n\n  @@unique([userId, courseId])\n  @@index([userId])\n  @@index([verificationId])\n  @@map(\"issued_certificates\")\n}\n\n// ============================================================================\n// USER PROFILE & SKILLS\n// ============================================================================\n\nmodel Skill {\n  id       String      @id @default(uuid())\n  name     String      @unique\n  ar_name  String?\n  category String?\n  users    UserSkill[]\n\n  @@map(\"skills\")\n}\n\nmodel UserSkill {\n  id        String     @id @default(uuid())\n  user      User       @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId    String\n  skill     Skill      @relation(fields: [skillId], references: [id], onDelete: Cascade)\n  skillId   String\n  level     SkillLevel @default(BEGINNER)\n  progress  Int        @default(0)\n  updatedAt DateTime   @updatedAt\n\n  @@unique([userId, skillId])\n  @@index([userId])\n  @@map(\"user_skills\")\n}\n\nmodel Education {\n  id             String  @id @default(uuid())\n  user           User    @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId         String\n  institution    String\n  ar_institution String?\n  degree         String\n  ar_degree      String?\n  field          String\n  ar_field       String?\n  startYear      Int\n  endYear        Int?\n  isCurrent      Boolean @default(false)\n\n  @@index([userId])\n  @@map(\"education\")\n}\n\nmodel SocialLink {\n  id     String         @id @default(uuid())\n  user   User           @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId String\n  type   SocialPlatform\n  url    String\n\n  @@index([userId])\n  @@map(\"social_links\")\n}\n\nmodel Certification {\n  id            String    @id @default(uuid())\n  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId        String\n  title         String\n  ar_title      String?\n  issuer        String\n  ar_issuer     String?\n  issueDate     DateTime\n  expireDate    DateTime?\n  credentialId  String?\n  credentialUrl String?\n\n  @@index([userId])\n  @@map(\"certifications\")\n}\n\nmodel CareerPath {\n  id             String  @id @default(uuid())\n  name           String  @unique\n  ar_name        String?\n  description    String?\n  ar_description String?\n  iconUrl        String?\n\n  users UserCareerPath[]\n\n  @@map(\"career_paths\")\n}\n\nmodel UserCareerPath {\n  id           String     @id @default(uuid())\n  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId       String\n  careerPath   CareerPath @relation(fields: [careerPathId], references: [id], onDelete: Cascade)\n  careerPathId String\n  progress     Int        @default(0)\n  startedAt    DateTime   @default(now())\n  completedAt  DateTime?\n\n  @@unique([userId, careerPathId])\n  @@index([userId])\n  @@map(\"user_career_paths\")\n}\n\n// ============================================================================\n// COMMUNITY & DISCUSSIONS\n// ============================================================================\n\nmodel Discussion {\n  id         String   @id @default(uuid())\n  courseId   String?\n  course     Course?  @relation(fields: [courseId], references: [id], onDelete: SetNull)\n  labId      String?\n  lab        Lab?     @relation(fields: [labId], references: [id], onDelete: SetNull)\n  userId     String\n  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  title      String\n  ar_title   String?\n  content    String   @db.Text\n  ar_content String?  @db.Text\n  isPinned   Boolean  @default(false)\n  isClosed   Boolean  @default(false)\n  views      Int      @default(0)\n  createdAt  DateTime @default(now())\n  updatedAt  DateTime @updatedAt\n\n  comments Comment[]\n\n  @@index([courseId])\n  @@index([labId])\n  @@index([userId])\n  @@index([createdAt])\n  @@map(\"discussions\")\n}\n\nmodel Comment {\n  id           String     @id @default(uuid())\n  discussionId String\n  discussion   Discussion @relation(fields: [discussionId], references: [id], onDelete: Cascade)\n  userId       String\n  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)\n  content      String     @db.Text\n  ar_content   String?    @db.Text\n  isEdited     Boolean    @default(false)\n  createdAt    DateTime   @default(now())\n  updatedAt    DateTime   @updatedAt\n\n  @@index([discussionId])\n  @@index([userId])\n  @@index([createdAt])\n  @@map(\"comments\")\n}\n\nmodel LabReview {\n  id        String   @id @default(uuid())\n  labId     String\n  lab       Lab      @relation(fields: [labId], references: [id], onDelete: Cascade)\n  userId    String\n  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  rating    Int\n  review    String?  @db.Text\n  ar_review String?  @db.Text\n  createdAt DateTime @default(now())\n\n  @@unique([labId, userId])\n  @@index([labId])\n  @@index([userId])\n  @@map(\"lab_reviews\")\n}\n\nmodel CourseReview {\n  id        String   @id @default(uuid())\n  courseId  String\n  course    Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)\n  userId    String\n  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  rating    Int\n  review    String?  @db.Text\n  ar_review String?  @db.Text\n  createdAt DateTime @default(now())\n\n  @@unique([courseId, userId])\n  @@index([courseId])\n  @@index([userId])\n  @@map(\"course_reviews\")\n}\n\n// ============================================================================\n// SUBSCRIPTIONS & BILLING\n// ============================================================================\n\nmodel SubscriptionPlan {\n  id             String               @id @default(uuid())\n  name           String               @unique\n  ar_name        String?\n  description    String?\n  ar_description String?\n  price          Float\n  stripePriceId String?\n  duration       SubscriptionDuration\n  features       String[]\n  ar_features    String[]\n  isActive       Boolean              @default(true)\n  createdAt      DateTime             @default(now())\n  updatedAt      DateTime             @updatedAt\n\n  subscriptions Subscription[]\n\n  @@map(\"subscription_plans\")\n}\n\nmodel Subscription {\n  id     String           @id @default(uuid())\n  user   User             @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId String\n  plan   SubscriptionPlan @relation(fields: [planId], references: [id], onDelete: Cascade)\n  planId String\n\n  // Stripe & Payment Fields\n  stripeCustomerId     String?\n  stripeSubscriptionId String?            @unique\n  stripePriceId        String?\n  status               SubscriptionStatus @default(ACTIVE)\n  billingCycle         BillingCycle       @default(MONTHLY)\n  currentPeriodEnd     DateTime?\n  cancelAtPeriodEnd    Boolean            @default(false)\n  trialEnd             DateTime?\n  paymobOrderId        String? // Placeholder for Paymob integration later\n\n  startDate DateTime  @default(now())\n  endDate   DateTime?\n  isActive  Boolean   @default(true)\n\n  @@index([userId])\n  @@index([planId])\n  @@index([stripeSubscriptionId])\n  @@map(\"subscriptions\")\n}\n\n// ============================================================================\n// FAVORITES & LEARNING PATHS (NEW V2)\n// ============================================================================\n\nmodel CourseFavorite {\n  id        String   @id @default(uuid())\n  userId    String\n  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  courseId  String\n  course    Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)\n  createdAt DateTime @default(now())\n\n  @@unique([userId, courseId])\n  @@index([userId])\n  @@index([courseId])\n  @@map(\"course_favorites\")\n}\n\nmodel LearningPath {\n  id              String       @id @default(uuid())\n  slug            String       @unique\n  title           String\n  ar_title        String?\n  description     String?\n  ar_description  String?\n  longDescription String?      @db.Text\n  ar_longDescription String?   @db.Text\n  iconName        String       @default(\"Map\")\n  color           CourseColor  @default(BLUE)\n  difficulty      Difficulty   @default(BEGINNER)\n  order           Int          @default(0)\n  \n  totalModules    Int          @default(0)\n  totalCourses    Int          @default(0)\n  totalLabs       Int          @default(0)\n  estimatedHours  Int          @default(0)\n  \n  tags            String[]\n  ar_tags         String[]\n  prerequisites   String[]\n  ar_prerequisites String[]\n  skills          String[]\n  ar_skills       String[]\n\n  isNew           Boolean      @default(false)\n  isFeatured      Boolean      @default(false)\n  isComingSoon    Boolean      @default(false)\n  isPublished     Boolean      @default(false)\n\n  createdAt       DateTime     @default(now())\n  updatedAt       DateTime     @updatedAt\n\n  modules     PathModule[]\n  enrollments PathEnrollment[]\n\n  @@map(\"learning_paths\")\n}\n\nmodel PathModule {\n  id             String       @id @default(uuid())\n  pathId         String\n  path           LearningPath @relation(fields: [pathId], references: [id], onDelete: Cascade)\n  \n  order          Int\n  title          String\n  ar_title       String?\n  description    String?\n  ar_description String?\n  type           PathModuleType   @default(COURSE)\n  status         PathModuleStatus @default(PUBLISHED)\n  estimatedHours Int          @default(0)\n  isLocked       Boolean      @default(false)\n  \n  // Link to existing resources (optional, used if type is COURSE or LAB)\n  courseId       String?\n  course         Course?      @relation(fields: [courseId], references: [id], onDelete: SetNull)\n  labId          String?\n  lab            Lab?         @relation(fields: [labId], references: [id], onDelete: SetNull)\n\n  @@unique([pathId, order])\n  @@map(\"path_modules\")\n}\n\nmodel PathEnrollment {\n  id          String       @id @default(uuid())\n  userId      String\n  user        User         @relation(fields: [userId], references: [id], onDelete: Cascade)\n  pathId      String\n  path        LearningPath @relation(fields: [pathId], references: [id], onDelete: Cascade)\n  progress    Float        @default(0)\n  isCompleted Boolean      @default(false)\n  enrolledAt  DateTime     @default(now())\n  completedAt DateTime?\n\n  @@unique([userId, pathId])\n  @@index([userId])\n  @@map(\"path_enrollments\")\n}\n\n// ============================================================================\n// GOALS\n// ============================================================================\n\nenum GoalFrequency {\n  DAILY\n  WEEKLY\n  MONTHLY\n  CUSTOM\n}\n\nenum GoalStatus {\n  ACTIVE\n  COMPLETED\n  PAUSED\n  ARCHIVED\n}\n\nmodel Goal {\n  id           String        @id @default(uuid())\n  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId       String\n  title        String\n  ar_title     String?\n  description  String?\n  targetValue  Int           @default(1)\n  currentValue Int           @default(0)\n  frequency    GoalFrequency @default(WEEKLY)\n  status       GoalStatus    @default(ACTIVE)\n  dueDate      DateTime?\n  completedAt  DateTime?\n  createdAt    DateTime      @default(now())\n  updatedAt    DateTime      @updatedAt\n\n  @@index([userId, status])\n  @@index([userId, frequency])\n  @@map(\"goals\")\n}\n\n// ============================================================================\n// STATS & ANALYTICS\n// ============================================================================\n\nmodel UserStats {\n  id                  String    @id @default(uuid())\n  user                User      @relation(fields: [userId], references: [id], onDelete: Cascade)\n  userId              String    @unique\n  totalHours          Int       @default(0)\n  activeDays          Int       @default(0)\n  completedLabs       Int       @default(0)\n  completedCourses    Int       @default(0)\n  badgesCount         Int       @default(0)\n  certificationsCount Int       @default(0)\n  profileCompletion   Int       @default(0)\n  currentStreak       Int       @default(0)\n  longestStreak       Int       @default(0)\n  lastActivityDate    DateTime?\n  updatedAt           DateTime  @updatedAt\n\n  @@map(\"user_stats\")\n}\n\n// ============================================================================\n// CONTACT & SUPPORT\n// ============================================================================\n\nmodel ContactSubmission {\n  id        String    @id @default(uuid())\n  firstName String\n  lastName  String\n  phone     String?\n  email     String\n  message   String    @db.Text\n  isRead    Boolean   @default(false)\n  repliedAt DateTime?\n  createdAt DateTime  @default(now())\n\n  @@index([createdAt])\n  @@index([isRead])\n  @@map(\"contact_submissions\")\n}\n\nmodel LabSubmission {\n  id     String @id @default(uuid())\n  userId String\n  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)\n  labId  String\n  lab    Lab    @relation(fields: [labId], references: [id], onDelete: Cascade)\n\n  // Submission data\n  code       String? @db.Text\n  flagAnswer String?\n  isCorrect  Boolean @default(false)\n\n  // Points calculation\n  timeTaken     Int // seconds\n  attemptNumber Int @default(1)\n  pointsEarned  Int @default(0)\n  xpEarned      Int @default(0)\n\n  // Metadata\n  submittedAt DateTime @default(now())\n  ipAddress   String?\n\n  @@index([userId, labId])\n  @@index([submittedAt])\n  @@map(\"lab_submissions\")\n}\n\n// ============================================================================\n// LAB-SPECIFIC MODELS (Keep as is for vulnerable labs)\n// ============================================================================\n// Login, JWT, SQLi, Broken Auth\nmodel LabGenericUser {\n  id       String  @id @default(cuid())\n  userId   String\n  labId    String\n  username String\n  password String\n  role     String  @default(\"user\")\n  email    String?\n  isStatic Boolean @default(false)\n  meta     Json?\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n  lab  Lab  @relation(fields: [labId], references: [id], onDelete: Cascade)\n\n  @@unique([userId, labId, username])\n}\n\n// Money, IDOR, Race Condition, CSRF\nmodel LabGenericBank {\n  id        String  @id @default(cuid())\n  userId    String\n  labId     String\n  accountNo String\n  balance   Float   @default(1000)\n  ownerName String?\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n  lab  Lab  @relation(fields: [labId], references: [id], onDelete: Cascade)\n\n  @@unique([userId, labId, accountNo])\n}\n\n// Posts, Comments, Files (XSS, SSTI, Path Traversal)\nmodel LabGenericContent {\n  id       String  @id @default(cuid())\n  userId   String\n  labId    String\n  title    String?\n  body     String  @db.Text\n  isPublic Boolean @default(true)\n  author   String?\n  fileUrl  String?\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n  lab  Lab  @relation(fields: [labId], references: [id], onDelete: Cascade)\n\n  @@index([userId, labId])\n}\n\n// (Payments, Logs, Coupons)\nmodel LabGenericLog {\n  id        String   @id @default(cuid())\n  userId    String\n  labId     String\n  type      String // \"PAYMENT\" | \"COUPON\" | \"LOGIN_LOG\" | \"FILE_UPLOAD\"\n  value     Float?\n  action    String?\n  meta      Json?\n  createdAt DateTime @default(now())\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n  lab  Lab  @relation(fields: [labId], references: [id], onDelete: Cascade)\n\n  @@index([userId, labId])\n}\n